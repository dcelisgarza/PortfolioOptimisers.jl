import{_ as p,C as h,o as r,c as k,j as i,a as e,E as t,aA as l,w as n}from"./chunks/framework.BhGxyTw1.js";const A=JSON.parse('{"title":"Pre-processing","description":"","frontmatter":{},"headers":[],"relativePath":"api/03_Preprocessing.md","filePath":"api/03_Preprocessing.md","lastUpdated":null}'),o={name:"api/03_Preprocessing.md"},d={class:"jldocstring custom-block",open:""},c={class:"jldocstring custom-block",open:""},g={class:"jldocstring custom-block",open:""},E={class:"jldocstring custom-block",open:""},y={class:"jldocstring custom-block",open:""},u={class:"jldocstring custom-block",open:""};function F(m,s,C,f,b,B){const a=h("Badge");return r(),k("div",null,[s[24]||(s[24]=i("h1",{id:"Pre-processing",tabindex:"-1"},[e("Pre-processing "),i("a",{class:"header-anchor",href:"#Pre-processing","aria-label":'Permalink to "Pre-processing {#Pre-processing}"'},"​")],-1)),s[25]||(s[25]=i("h2",{id:"Prices-to-returns",tabindex:"-1"},[e("Prices to returns "),i("a",{class:"header-anchor",href:"#Prices-to-returns","aria-label":'Permalink to "Prices to returns {#Prices-to-returns}"'},"​")],-1)),s[26]||(s[26]=i("p",null,[e("Other than ["),i("code",null,"FiniteAllocationOptimisationEstimator"),e("]-(@ref), all optimisations work based off returns data rather than price data. These functions and types are involved in computing returns.")],-1)),i("details",d,[i("summary",null,[s[0]||(s[0]=i("a",{id:"PortfolioOptimisers.AbstractReturnsResult",href:"#PortfolioOptimisers.AbstractReturnsResult"},[i("span",{class:"jlbinding"},"PortfolioOptimisers.AbstractReturnsResult")],-1)),s[1]||(s[1]=e()),t(a,{type:"info",class:"jlObjectType jlType",text:"Type"})]),s[3]||(s[3]=l('<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">abstract type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> AbstractReturnsResult </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> AbstractResult</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> end</span></span></code></pre></div><p>Abstract supertype for all returns result types in <code>PortfolioOptimisers.jl</code>.</p><p>All concrete types representing the result of returns calculations should subtype <code>AbstractReturnsResult</code>.</p><p><strong>Related</strong></p><ul><li><p><a href="/PortfolioOptimisers.jl/previews/PR65/api/01_Base#PortfolioOptimisers.AbstractResult"><code>AbstractResult</code></a></p></li><li><p><a href="/PortfolioOptimisers.jl/previews/PR65/api/03_Preprocessing#PortfolioOptimisers.ReturnsResult"><code>ReturnsResult</code></a></p></li></ul>',5)),t(a,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[2]||(s[2]=[i("a",{href:"https://github.com/dcelisgarza/PortfolioOptimisers.jl/blob/7e52bbaae634430bd1b89641cfbe7ca9d68268a6/src/03_Preprocessing.jl#L1-L12",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),i("details",c,[i("summary",null,[s[4]||(s[4]=i("a",{id:"PortfolioOptimisers.ReturnsResult",href:"#PortfolioOptimisers.ReturnsResult"},[i("span",{class:"jlbinding"},"PortfolioOptimisers.ReturnsResult")],-1)),s[5]||(s[5]=e()),t(a,{type:"info",class:"jlObjectType jlType",text:"Type"})]),s[7]||(s[7]=l(`<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">struct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ReturnsResult{T1, T2, T3, T4, T5, T6, T7} </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> AbstractReturnsResult</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    nx</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">T1</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    X</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">T2</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    nf</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">T3</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    F</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">T4</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ts</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">T5</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    iv</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">T6</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ivpa</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">T7</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">end</span></span></code></pre></div><p>A flexible container type for storing the results of asset and factor returns calculations in <code>PortfolioOptimisers.jl</code>.</p><p><code>ReturnsResult</code> is the standard result type returned by returns-processing routines, such as <a href="/PortfolioOptimisers.jl/previews/PR65/api/03_Preprocessing#PortfolioOptimisers.prices_to_returns"><code>prices_to_returns</code></a>.</p><p>It supports both asset and factor returns, as well as optional time series and implied volatility information, and is designed for downstream compatibility with optimisation and analysis routines.</p><p><strong>Fields</strong></p><ul><li><p><code>nx</code>: Names or identifiers of asset columns (assets × 1).</p></li><li><p><code>X</code>: Asset returns matrix (observations × assets).</p></li><li><p><code>nf</code>: Names or identifiers of factor columns (factors × 1).</p></li><li><p><code>F</code>: Factor returns matrix (observations × factors).</p></li><li><p><code>ts</code>: Optional timestamps for each observation (observations × 1).</p></li><li><p><code>iv</code>: Implied volatilities matrix (observations × assets).</p></li><li><p><code>ivpa</code>: Implied volatility risk premium adjustment, if a vector (assets × 1).</p></li></ul><p><strong>Constructor</strong></p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ReturnsResult</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(; nx</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Option{&lt;:VecStr}</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> nothing</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, X</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Option{&lt;:MatNum}</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> nothing</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">              nf</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Option{&lt;:VecStr}</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> nothing</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, F</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Option{&lt;:MatNum}</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> nothing</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">              ts</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Option{&lt;:VecDate}</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> nothing</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, iv</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Option{&lt;:MatNum}</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> nothing</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">              ivpa</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Option{&lt;:Num_VecNum}</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> nothing</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Keyword arguments correspond to the fields above.</p><p><strong>Validation</strong></p><ul><li><p>If <code>nx</code> or <code>X</code> is not <code>nothing</code>, <code>!isempty(nx)</code>, <code>!isempty(X)</code>, and <code>length(nx) == size(X, 2)</code>.</p></li><li><p>If <code>nf</code> or <code>F</code> is not <code>nothing</code>, <code>!isempty(nf)</code>, <code>!isempty(F)</code>, and <code>length(nf) == size(F, 2)</code>, and <code>size(X, 1) == size(F, 1)</code>.</p></li><li><p>If <code>ts</code> is not <code>nothing</code>, <code>!isempty(ts)</code>, and <code>length(ts) == size(X, 1)</code>.</p></li><li><p>If <code>iv</code> is not <code>nothing</code>, <code>!isempty(iv)</code>, <code>all(x -&gt; x &gt;= 0, iv)</code>, <code>size(iv) == size(X)</code>.</p></li><li><p>If <code>ivpa</code> is not <code>nothing</code>, <code>all(x -&gt; x &gt;= 0, ivpa)</code>, <code>all(x -&gt; isfinite(x), ivpa)</code>; if a vector, <code>length(ivpa) == size(iv, 2)</code>.</p></li></ul><p><strong>Examples</strong></p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">julia</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> ReturnsResult</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(; nx </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;A&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;B&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], X </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.1</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0.2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.3</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0.4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">])</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ReturnsResult</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    nx ┼ Vector{String}</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;A&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;B&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">     X ┼ </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">×</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Matrix{Float64}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    nf ┼ </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">nothing</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">     F ┼ </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">nothing</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ts ┼ </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">nothing</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    iv ┼ </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">nothing</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  ivpa ┴ </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">nothing</span></span></code></pre></div><p><strong>Related</strong></p><ul><li><p><a href="/PortfolioOptimisers.jl/previews/PR65/api/03_Preprocessing#PortfolioOptimisers.AbstractReturnsResult"><code>AbstractReturnsResult</code></a></p></li><li><p><a href="/PortfolioOptimisers.jl/previews/PR65/api/03_Preprocessing#PortfolioOptimisers.prices_to_returns"><code>prices_to_returns</code></a></p></li><li><p><a href="/PortfolioOptimisers.jl/previews/PR65/api/01_Base#PortfolioOptimisers.Option"><code>Option</code></a></p></li><li><p><a href="/PortfolioOptimisers.jl/previews/PR65/api/01_Base#PortfolioOptimisers.VecStr"><code>VecStr</code></a></p></li><li><p><a href="/PortfolioOptimisers.jl/previews/PR65/api/01_Base#PortfolioOptimisers.MatNum"><code>MatNum</code></a></p></li><li><p><a href="/PortfolioOptimisers.jl/previews/PR65/api/01_Base#PortfolioOptimisers.VecDate"><code>VecDate</code></a></p></li><li><p><a href="/PortfolioOptimisers.jl/previews/PR65/api/01_Base#PortfolioOptimisers.Num_VecNum"><code>Num_VecNum</code></a></p></li></ul>`,15)),t(a,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[6]||(s[6]=[i("a",{href:"https://github.com/dcelisgarza/PortfolioOptimisers.jl/blob/7e52bbaae634430bd1b89641cfbe7ca9d68268a6/src/03_Preprocessing.jl#L59-L126",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),i("details",g,[i("summary",null,[s[8]||(s[8]=i("a",{id:"PortfolioOptimisers._check_names_and_returns_matrix",href:"#PortfolioOptimisers._check_names_and_returns_matrix"},[i("span",{class:"jlbinding"},"PortfolioOptimisers._check_names_and_returns_matrix")],-1)),s[9]||(s[9]=e()),t(a,{type:"info",class:"jlObjectType jlFunction",text:"Function"})]),s[11]||(s[11]=l(`<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">_check_names_and_returns_matrix</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(names</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Option{&lt;:VecStr}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, mat</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Option{&lt;:MatNum}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                                names_sym</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Symbol</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, mat_sym</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Symbol</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Validate that asset or factor names and their corresponding returns matrix are provided and consistent.</p><p><strong>Arguments</strong></p><ul><li><p><code>names</code>: Asset or factor names.</p></li><li><p><code>mat</code>: Returns matrix.</p></li><li><p><code>names_sym</code>: Symbolic name for the names argument displayed in error messages.</p></li><li><p><code>mat_sym</code>: Symbolic name for the matrix argument displayed in error messages.</p></li></ul><p><strong>Returns</strong></p><ul><li><code>nothing</code>.</li></ul><p><strong>Details</strong></p><ul><li>If either <code>names</code> or <code>mat</code> is not <code>nothing</code>: <ul><li><p><code>!isnothing(names)</code> and <code>!isnothing(mat)</code>.</p></li><li><p><code>!isempty(names)</code> and <code>!isempty(mat)</code>.</p></li><li><p><code>length(names) == size(mat, 2)</code>.</p></li></ul></li></ul><p><strong>Related</strong></p><ul><li><p><a href="/PortfolioOptimisers.jl/previews/PR65/api/03_Preprocessing#PortfolioOptimisers.ReturnsResult"><code>ReturnsResult</code></a></p></li><li><p><a href="/PortfolioOptimisers.jl/previews/PR65/api/01_Base#PortfolioOptimisers.Option"><code>Option</code></a></p></li><li><p><a href="/PortfolioOptimisers.jl/previews/PR65/api/01_Base#PortfolioOptimisers.VecStr"><code>VecStr</code></a></p></li><li><p><a href="/PortfolioOptimisers.jl/previews/PR65/api/01_Base#PortfolioOptimisers.MatNum"><code>MatNum</code></a></p></li></ul>`,10)),t(a,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[10]||(s[10]=[i("a",{href:"https://github.com/dcelisgarza/PortfolioOptimisers.jl/blob/7e52bbaae634430bd1b89641cfbe7ca9d68268a6/src/03_Preprocessing.jl#L14-L45",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),i("details",E,[i("summary",null,[s[12]||(s[12]=i("a",{id:"PortfolioOptimisers.prices_to_returns",href:"#PortfolioOptimisers.prices_to_returns"},[i("span",{class:"jlbinding"},"PortfolioOptimisers.prices_to_returns")],-1)),s[13]||(s[13]=e()),t(a,{type:"info",class:"jlObjectType jlFunction",text:"Function"})]),s[15]||(s[15]=l(`<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">prices_to_returns</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(X</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">TimeSeries.TimeArray</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; F</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Option{TimeSeries.TimeArray}</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> nothing</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                  B</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Option{&lt;:TimeSeries.TimeArray}</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> nothing</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                  iv</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Option{&lt;:TimeSeries.TimeArray}</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> nothing</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                  ivpa</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Option{&lt;:Num_VecNum}</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> nothing</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, ret_method</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Symbol</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> :simple</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                  padding</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Bool</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, missing_col_percent</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Number</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                  missing_row_percent</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Option{&lt;:Number}</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, collapse_args</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Tuple</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                  map_func</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Option{&lt;:Function}</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> nothing</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, join_method</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Symbol</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> :outer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                  impute_method</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Option{&lt;:Impute.Imputor}</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> nothing</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Convert price data (and optionally factor data) in <code>TimeSeries.TimeArray</code> format to returns, with flexible handling of missing data, imputation, and optional implied volatility information.</p><p><strong>Arguments</strong></p><ul><li><p><code>X</code>: Asset price data (observations × assets).</p></li><li><p><code>F</code>: Optional Factor price data (observations × factors).</p></li><li><p><code>B</code>: Optional Benchmark price data (observations × assets) or (observations × 1).</p></li><li><p><code>iv</code>: Optional Implied volatility data.</p></li><li><p><code>ivpa</code>: Optional Implied volatility risk premium adjustment.</p></li><li><p><code>ret_method</code>: Return calculation method (<code>:simple</code> or <code>:log</code>).</p></li><li><p><code>padding</code>: Whether to pad missing values in returns calculation.</p></li><li><p><code>missing_col_percent</code>: Maximum allowed fraction <code>(0, 1]</code> of missing values per column (asset + factor).</p></li><li><p><code>missing_row_percent</code>: Maximum allowed fraction <code>(0, 1]</code> of missing values per row (timestamp).</p></li><li><p><code>collapse_args</code>: Arguments for collapsing the time series (e.g., to lower frequency).</p></li><li><p><code>map_func</code>: Optional function to apply to the data before returns calculation.</p></li><li><p><code>join_method</code>: How to join asset and factor data (<code>:outer</code>, <code>:inner</code>, etc.).</p></li><li><p><code>impute_method</code>: Optional imputation method for missing data.</p></li></ul><p><strong>Returns</strong></p><ul><li><code>rr::ReturnsResult</code>: Struct containing asset/factor returns, names, time series, and optional implied volatility data.</li></ul><p><strong>Validation</strong></p><ul><li><p><code>!isempty(X)</code>.</p></li><li><p><code>0 &lt; missing_col_percent &lt;= 1</code></p></li><li><p><code>0 &lt; missing_row_percent &lt;= 1</code>.</p></li><li><p>If <code>F</code> is not <code>nothing</code>, <code>!isempty(F)</code>.</p></li><li><p>If <code>B</code> is not <code>nothing</code>, <code>!isempty(B)</code>, and <code>size(values(B), 2) in (1, size(values(X), 2))</code>.</p></li><li><p>If <code>iv</code> is not <code>nothing</code>, the timestamp of the merged data matrix must be a subset of <code>TimeSeries.timestamp(iv)</code>, then <code>iv = values(iv)</code>, <code>!isempty(iv)</code>, <code>all(x -&gt; x &gt;= 0, iv)</code>, <code>size(iv) == size(X)</code>.</p></li><li><p>If <code>ivpa</code> is not <code>nothing</code>, <code>all(x -&gt; x &gt;= 0, ivpa)</code>, <code>all(x -&gt; isfinite(x), ivpa)</code>; if a vector, <code>length(ivpa) == size(iv, 2)</code>.</p></li></ul><p><strong>Details</strong></p><ul><li><p>Joins asset, factor, and benchmark data as specified.</p></li><li><p>Optionally applies a mapping function and/or collapses the time series.</p></li><li><p>Handles missing values by filtering, imputation, and dropping as configured.</p></li><li><p>Computes returns using the specified method.</p><ul><li>If <code>B</code> is not <code>nothing</code>, it is subtracted from asset returns. Used for returns tracking error optimisations.</li></ul></li><li><p>Returns a <code>ReturnsResult</code> with asset/factor names, returns, timestamps, and optional implied volatility data.</p></li></ul><p><strong>Examples</strong></p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">julia</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> using</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> TimeSeries</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">julia</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> X </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> TimeArray</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Date</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2020</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Day</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Date</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2020</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">), [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">100</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 101</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">102</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 103</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">104</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 105</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                     [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;A&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;B&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">])</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">×</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> TimeSeries</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">TimeArray{Int64, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, Dates</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Date, Matrix{Int64}} </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2020</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">01</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">01</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> to </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2020</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">01</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">03</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">┌────────────┬─────┬─────┐</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">│            │ A   │ B   │</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">├────────────┼─────┼─────┤</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">│ </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2020</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">01</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">01</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> │ </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">100</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> │ </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">101</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> │</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">│ </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2020</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">01</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">02</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> │ </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">102</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> │ </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">103</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> │</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">│ </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2020</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">01</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">03</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> │ </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">104</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> │ </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">105</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> │</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">└────────────┴─────┴─────┘</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">julia</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> prices_to_returns</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(X)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ReturnsResult</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    nx ┼ Vector{String}</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;A&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;B&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">     X ┼ </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">×</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Matrix{Float64}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    nf ┼ </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">nothing</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">     F ┼ </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">nothing</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ts ┼ Vector{Dates</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Date}</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [Dates</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Date</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;2020-01-02&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">), Dates</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Date</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;2020-01-03&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    iv ┼ </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">nothing</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  ivpa ┴ </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">nothing</span></span></code></pre></div><p><strong>Related</strong></p><ul><li><p><a href="/PortfolioOptimisers.jl/previews/PR65/api/03_Preprocessing#PortfolioOptimisers.ReturnsResult"><code>ReturnsResult</code></a></p></li><li><p><a href="/PortfolioOptimisers.jl/previews/PR65/api/01_Base#PortfolioOptimisers.Option"><code>Option</code></a></p></li><li><p><a href="/PortfolioOptimisers.jl/previews/PR65/api/01_Base#PortfolioOptimisers.VecStr"><code>VecStr</code></a></p></li><li><p><a href="/PortfolioOptimisers.jl/previews/PR65/api/01_Base#PortfolioOptimisers.MatNum"><code>MatNum</code></a></p></li><li><p><a href="/PortfolioOptimisers.jl/previews/PR65/api/01_Base#PortfolioOptimisers.VecDate"><code>VecDate</code></a></p></li><li><p><a href="/PortfolioOptimisers.jl/previews/PR65/api/01_Base#PortfolioOptimisers.Num_VecNum"><code>Num_VecNum</code></a></p></li><li><p><a href="https://juliastats.org/TimeSeries.jl/stable/timearray/#The-TimeArray-time-series-type" target="_blank" rel="noreferrer"><code>TimeSeries</code></a></p></li><li><p><a href="https://github.com/invenia/Impute.jl" target="_blank" rel="noreferrer"><code>Impute</code></a></p></li></ul>`,14)),t(a,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[14]||(s[14]=[i("a",{href:"https://github.com/dcelisgarza/PortfolioOptimisers.jl/blob/7e52bbaae634430bd1b89641cfbe7ca9d68268a6/src/03_Preprocessing.jl#L231-L321",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),s[27]||(s[27]=i("h2",{id:"Pre-filtering",tabindex:"-1"},[e("Pre-filtering "),i("a",{class:"header-anchor",href:"#Pre-filtering","aria-label":'Permalink to "Pre-filtering {#Pre-filtering}"'},"​")],-1)),s[28]||(s[28]=i("p",null,"Price data is often incomplete or noisy, so it can be worthwhile having some pre-filtering steps to remove data that does not contribute meaningful information and may pollute calculations.",-1)),i("details",y,[i("summary",null,[s[16]||(s[16]=i("a",{id:"PortfolioOptimisers.find_complete_indices",href:"#PortfolioOptimisers.find_complete_indices"},[i("span",{class:"jlbinding"},"PortfolioOptimisers.find_complete_indices")],-1)),s[17]||(s[17]=e()),t(a,{type:"info",class:"jlObjectType jlFunction",text:"Function"})]),s[19]||(s[19]=l(`<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">find_complete_indices</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(X</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">AbstractMatrix</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; dims</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Int</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Return the indices of columns (or rows) in matrix <code>X</code> that do not contain any missing or NaN values.</p><p>This function scans the specified dimension of the input matrix and returns the indices of columns (or rows) that are complete, i.e., contain no <code>missing</code> or <code>NaN</code> values.</p><p><strong>Arguments</strong></p><ul><li><p><code>X</code>: Input matrix of numeric values (observations × assets).</p></li><li><p><code>dims</code>: Dimension along which to check for completeness (<code>1</code> for columns, <code>2</code> for rows). Default is <code>1</code>.</p></li></ul><p><strong>Returns</strong></p><ul><li><code>res::Vector{Int}</code>: Indices of columns (or rows) in <code>X</code> that are complete.</li></ul><p><strong>Validation</strong></p><ul><li><code>dims in (1, 2)</code>.</li></ul><p><strong>Details</strong></p><ul><li><p>If <code>dims == 2</code>, the matrix is transposed and columns are checked.</p></li><li><p>Any column (or row) containing at least one <code>missing</code> or <code>NaN</code> value is excluded.</p></li><li><p>The result is a vector of indices of complete columns (or rows).</p></li></ul><p><strong>Examples</strong></p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">julia</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> X </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2.0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> NaN</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4.0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> missing</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 6.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">];</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">julia</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> find_complete_indices</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(X)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">element Vector{Int64}</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">julia</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> find_complete_indices</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(X; dims </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Int64[]</span></span></code></pre></div><p><strong>Related</strong></p><ul><li><p>[<code>find_uncorrelated_indices</code>]-(@ref)</p></li><li><p><a href="/PortfolioOptimisers.jl/previews/PR65/api/03_Preprocessing#PortfolioOptimisers.prices_to_returns"><code>prices_to_returns</code></a></p></li></ul>`,15)),t(a,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[18]||(s[18]=[i("a",{href:"https://github.com/dcelisgarza/PortfolioOptimisers.jl/blob/7e52bbaae634430bd1b89641cfbe7ca9d68268a6/src/03_Preprocessing.jl#L426-L469",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})]),i("details",u,[i("summary",null,[s[20]||(s[20]=i("a",{id:"PortfolioOptimisers.select_k_extremes",href:"#PortfolioOptimisers.select_k_extremes"},[i("span",{class:"jlbinding"},"PortfolioOptimisers.select_k_extremes")],-1)),s[21]||(s[21]=e()),t(a,{type:"info",class:"jlObjectType jlFunction",text:"Function"})]),s[23]||(s[23]=i("div",{class:"tip custom-block"},[i("p",{class:"custom-block-title"},"Note"),i("p",null,"Not implemented yet, still unexported.")],-1)),t(a,{type:"info",class:"source-link",text:"source"},{default:n(()=>[...s[22]||(s[22]=[i("a",{href:"https://github.com/dcelisgarza/PortfolioOptimisers.jl/blob/7e52bbaae634430bd1b89641cfbe7ca9d68268a6/src/03_Preprocessing.jl#L484-L488",target:"_blank",rel:"noreferrer"},"source",-1)])]),_:1})])])}const v=p(o,[["render",F]]);export{A as __pageData,v as default};
